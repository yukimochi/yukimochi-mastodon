FROM alpine:edge

RUN apk add -U --no-cache git openssh
RUN cd /tmp && \
    wget "https://caddyserver.com/download/linux/amd64?license=personal&telemetry=off" -O - | tar zx && \
    chmod +x caddy && \
    mv caddy /usr/bin && \
    rm -rf /tmp/*
WORKDIR /webroot
EXPOSE 80 443

COPY public/ /webroot

ENTRYPOINT [ "/usr/bin/caddy" ]
CMD [ "--conf", "/etc/caddy/Caddyfile", "--log", "stdout", "--root", "/var/tmp" ]
